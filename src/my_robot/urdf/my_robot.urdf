<?xml version="1.0"?>
<robot name="my_robot">

  <!-- ======================= -->
  <!-- Materials -->
  <!-- ======================= -->
  <material name="black">
    <color rgba="0.1 0.1 0.1 1.0"/>
  </material>

  <material name="blue">
    <color rgba="0.1 0.1 0.8 1.0"/>
  </material>

  <!-- ======================= -->
  <!-- Base -->
  <!-- ======================= -->
  <link name="base_link">
    <visual>
      <geometry>
        <box size="0.6 0.4 0.2"/>
      </geometry>
      <material name="blue"/>
    </visual>

    <collision>
      <geometry>
        <box size="0.6 0.4 0.2"/>
      </geometry>
    </collision>

    <inertial>
      <mass value="20.0"/>
      <origin xyz="0 0 0"/>
      <inertia
        ixx="0.5" ixy="0.0" ixz="0.0"
        iyy="0.8" iyz="0.0"
        izz="1.0"/>
    </inertial>
  </link>

  <!-- ======================= -->
  <!-- Wheel Parameters -->
  <!-- ======================= -->
  <!-- wheel radius: 0.1 m -->
  <!-- wheel width: 0.05 m -->
  <!-- wheelbase: 0.4 m -->
  <!-- track width: 0.3 m -->

  <!-- ======================= -->
  <!-- Rear Wheels (Driven) -->
  <!-- ======================= -->
  <link name="rear_left_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.1" length="0.05"/>
      </geometry>
      <material name="black"/>
      <origin rpy="1.5708 0 0"/>
    </visual>
  </link>

  <link name="rear_right_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.1" length="0.05"/>
      </geometry>
      <material name="black"/>
      <origin rpy="1.5708 0 0"/>
    </visual>
  </link>

  <joint name="rear_left_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="rear_left_wheel"/>
    <origin xyz="-0.2 0.15 -0.1"/>
    <axis xyz="0 1 0"/>
  </joint>

  <joint name="rear_right_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="rear_right_wheel"/>
    <origin xyz="-0.2 -0.15 -0.1"/>
    <axis xyz="0 1 0"/>
  </joint>

  <!-- ======================= -->
  <!-- Front Steering Joints -->
  <!-- ======================= -->
  <link name="front_left_steering"/>
  <link name="front_right_steering"/>

  <joint name="front_left_steering_joint" type="revolute">
    <parent link="base_link"/>
    <child link="front_left_steering"/>
    <origin xyz="0.2 0.15 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-0.6" upper="0.6" effort="5.0" velocity="1.0"/>
  </joint>

  <joint name="front_right_steering_joint" type="revolute">
    <parent link="base_link"/>
    <child link="front_right_steering"/>
    <origin xyz="0.2 -0.15 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-0.6" upper="0.6" effort="5.0" velocity="1.0"/>
  </joint>

  <!-- ======================= -->
  <!-- Front Wheels -->
  <!-- ======================= -->
  <link name="front_left_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.1" length="0.05"/>
      </geometry>
      <material name="black"/>
      <origin rpy="1.5708 0 0"/>
    </visual>
  </link>

  <link name="front_right_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.1" length="0.05"/>
      </geometry>
      <material name="black"/>
      <origin rpy="1.5708 0 0"/>
    </visual>
  </link>

  <joint name="front_left_wheel_joint" type="continuous">
    <parent link="front_left_steering"/>
    <child link="front_left_wheel"/>
    <origin xyz="0 0 -0.1"/>
    <axis xyz="0 1 0"/>
  </joint>

  <joint name="front_right_wheel_joint" type="continuous">
    <parent link="front_right_steering"/>
    <child link="front_right_wheel"/>
    <origin xyz="0 0 -0.1"/>
    <axis xyz="0 1 0"/>
  </joint>

  <gazebo>
    <plugin name="gazebo_ros2_control" filename="libgazebo_ros2_control.so"/>
  </gazebo>

  <transmission name="rear_left_wheel_trans">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="rear_left_wheel_joint">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
    </joint>
    <actuator name="rear_left_motor">
      <hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <ros2_control name="GazeboSystem" type="system">
    <hardware>
      <plugin>gazebo_ros2_control/GazeboSystem</plugin>
    </hardware>

    <joint name="rear_left_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="velocity"/>
      <state_interface name="position"/>
    </joint>
  </ros2_control>

  
</robot>

